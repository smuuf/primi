//
// Module "std.base64"
//

import std.base64
import _helpers: assert_error

//
// Sanity checks.
//

sample_string = 'this is <a href="javascript:void(0)">piece of HTML!</a>'
encoded = base64.encode(sample_string)
assert(encoded == 'dGhpcyBpcyA8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiPnBpZWNlIG9mIEhUTUwhPC9hPg==')

decoded = base64.decode('ZG9zdGFuZcWhIGZsw6FrYW5lYyDwn6SUIGxvbA==')
assert(decoded == 'dostaneÅ¡ flÃ¡kanec ðŸ¤” lol')

//
// Try the beginning of "Karel Hynek MÃ¡cha - MÃ¡j" ...
//

may = "Byl pozdnÃ­ veÄer â€“ prvnÃ­ mÃ¡j â€“
veÄernÃ­ mÃ¡j â€“ byl lÃ¡sky Äas.
HrdliÄÄin zval ku lÃ¡sce hlas,
kde borovÃ½ zavÃ¡nÄ›l hÃ¡j.
O lÃ¡sce Å¡eptal tichÃ½ mech;
kvÄ›toucÃ­ strom lhal lÃ¡sky Å¾el,
svou lÃ¡sku slavÃ­k rÅ¯Å¾i pÄ›l,
rÅ¯Å¾inu jevil vonnÃ½ vzdech.
Jezero hladkÃ© v kÅ™ovÃ­ch stinnÃ½ch
zvuÄelo temnÄ› tajnÃ½ bol,
bÅ™eh je objÃ­mal kol a kol;
a slunce jasnÃ¡ svÄ›tÅ¯ jinÃ½ch
bloudila blankytnÃ½mi pÃ¡sky,
planoucÃ­ tam co slzy lÃ¡sky."

encoded = base64.encode(may)
decoded = base64.decode(encoded)

assert(decoded == may)

//
// Errors.
//

_ = 'Decoding invalid base64 string should throw error'
assert_error(() => {
	tmp = some_list[9]
}, _)
